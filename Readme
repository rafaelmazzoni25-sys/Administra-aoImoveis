# Ferramenta Integrada de GestÃ£o ImobiliÃ¡ria

## ğŸ¯ Objetivo

Construir uma plataforma Ãºnica que permita que todos os setores da imobiliÃ¡ria acompanhem, em tempo real, a disponibilidade dos imÃ³veis, o andamento das negociaÃ§Ãµes, a execuÃ§Ã£o das vistorias, o tratamento das pendÃªncias e o cumprimento de tarefas operacionais.

## ğŸš€ ImplementaÃ§Ã£o de ReferÃªncia em C# (.NET 8)

O repositÃ³rio inclui uma soluÃ§Ã£o **multi-camada** escrita em C# que traduz o desenho funcional desta plataforma em um backend executÃ¡vel:

- `AdministraAoImoveis.Api` â€“ API REST mÃ­nima com Swagger e endpoints para imÃ³veis, negociaÃ§Ãµes, vistorias e tarefas.
- `AdministraAoImoveis.Application` â€“ ServiÃ§os de aplicaÃ§Ã£o que convertem os casos de uso do negÃ³cio em DTOs e orquestram os serviÃ§os de domÃ­nio.
- `AdministraAoImoveis.Domain` â€“ Entidades, agregados, enums e regras de negÃ³cio que espelham os mÃ³dulos descritos abaixo (disponibilidade, pipeline de negociaÃ§Ã£o, vistorias, tarefas, manutenÃ§Ã£o, agenda e documentos).
- `AdministraAoImoveis.Infrastructure` â€“ RepositÃ³rios em memÃ³ria e registro de dependÃªncias para acelerar prototipagem e testes.

### Como executar localmente

1. Instale o [.NET SDK 8.0](https://dotnet.microsoft.com/download).
2. No diretÃ³rio raiz, restaure e execute a API:
   ```bash
   dotnet restore
   dotnet run --project src/AdministraAoImoveis.Api/AdministraAoImoveis.Api.csproj
   ```
3. A API sobe (por padrÃ£o) em `https://localhost:5001` com documentaÃ§Ã£o interativa disponÃ­vel em `/swagger`.

Essa estrutura serve como ponto de partida: basta substituir os repositÃ³rios em memÃ³ria por uma implementaÃ§Ã£o real (EF Core, Dapper, etc.), conectar provedores de autenticaÃ§Ã£o e expandir os mÃ³dulos conforme a necessidade.

## ğŸ§­ VisÃ£o Geral da Arquitetura

| Camada | Principais responsabilidades | Tecnologias sugeridas |
| --- | --- | --- |
| **ApresentaÃ§Ã£o** | Portais web responsivos (interno, proprietÃ¡rio, interessado), dashboards gerenciais, calendÃ¡rio integrado. | React + Next.js, Chakra UI, TailwindCSS, i18n, SSR/SSG conforme mÃ³dulo. |
| **APIs e ServiÃ§os** | GraphQL/REST para CRUD de imÃ³veis, negociaÃ§Ãµes, vistorias, tarefas, documentos, integraÃ§Ãµes externas. | NestJS (Node.js) com mÃ³dulos independentes, CQRS opcional, Apollo GraphQL, Swagger. |
| **Processos AssÃ­ncronos** | Gatilhos automÃ¡ticos, notificaÃ§Ãµes, sincronizaÃ§Ãµes com agendas e CRMs. | NestJS Queues + BullMQ (Redis), cron jobs, webhooks. |
| **Dados e PersistÃªncia** | Bancos relacionais e de documentos, storage seguro de arquivos. | PostgreSQL + Prisma ORM, Redis para cache, S3 compatÃ­vel para arquivos. |
| **Observabilidade e SeguranÃ§a** | Monitoramento, logs de auditoria, RBAC e autenticaÃ§Ã£o. | Keycloak / Auth0 (OAuth2 + OpenID), Loki + Grafana, Prometheus, OpenTelemetry. |

> A arquitetura modular permite escalar cada domÃ­nio (negociaÃ§Ã£o, vistoria, manutenÃ§Ã£o etc.) de forma independente, mantendo integraÃ§Ã£o via barramento de eventos (ex.: Kafka/NATS) quando necessÃ¡rio.

## ğŸ‘¥ Perfis de Acesso

- **Admin**: gerenciamento completo, configuraÃ§Ãµes gerais.
- **Comercial**: pipeline de negociaÃ§Ãµes, CRM, propostas, contratos.
- **Vistoria**: agenda, checklists, laudos e geraÃ§Ã£o de pendÃªncias.
- **ManutenÃ§Ã£o**: ordens de serviÃ§o, pendÃªncias tÃ©cnicas, fornecedores.
- **Financeiro**: registros de pagamento, repasses, bloqueios.
- **JurÃ­dico**: contratos, assinaturas e auditoria documental.
- **ProprietÃ¡rio** (portal externo): visualizaÃ§Ã£o, relatÃ³rios, mensagens.
- **Interessado/LocatÃ¡rio** (portal externo): acompanhamento de negociaÃ§Ã£o.

RBAC fino (ler/criar/editar/excluir) controlado por recurso e aÃ§Ã£o, suportando delegaÃ§Ã£o e substituiÃ§Ã£o temporÃ¡ria (fÃ©rias).

## ğŸ—‚ï¸ DomÃ­nios e MÃ³dulos

### 1. Cadastro e Consulta de ImÃ³veis

- Dados completos (endereÃ§o, caracterÃ­sticas, proprietÃ¡rio, status, datas de liberaÃ§Ã£o).
- HistÃ³rico de ocupaÃ§Ãµes, manutenÃ§Ãµes, negociaÃ§Ãµes vinculadas ao imÃ³vel.
- Documentos anexados (contratos, laudos, fotos) com versionamento.
- Controle de disponibilidade com agenda de previsÃ£o.

### 2. GestÃ£o de Disponibilidade

- Estados suportados: `DISPONIVEL`, `RESERVADO`, `EM_NEGOCIACAO`, `OCUPADO`, `EM_VISTORIA_ENTRADA`, `EM_VISTORIA_SAIDA`, `EM_MANUTENCAO`, `INDISPONIVEL`, `AGENDADO_PARA_DISPONIBILIZACAO`.
- Regras automÃ¡ticas: uma negociaÃ§Ã£o ativa por imÃ³vel, geraÃ§Ã£o de vistoria em aviso de saÃ­da, bloqueio por pendÃªncias, retorno automÃ¡tico apÃ³s vistoria/manutenÃ§Ã£o concluÃ­da.

### 3. Pipeline de NegociaÃ§Ãµes (Kanban)

- Etapas: `LEAD_CAPTADO â†’ VISITA_AGENDADA â†’ PROPOSTA_ENVIADA â†’ DOCUMENTACAO_EM_ANALISE â†’ APROVACAO_CREDITO â†’ CONTRATO_EMITIDO â†’ ASSINATURA â†’ ENTREGA_DE_CHAVES`.
- Relacionamento com imÃ³vel, cliente e corretor.
- Controle de sinal, bloqueios temporÃ¡rios, validade de proposta e histÃ³rico de movimentaÃ§Ãµes.
- Alertas automÃ¡ticos em expiraÃ§Ã£o ou avanÃ§o de etapa.

### 4. GestÃ£o de Vistorias

- Tipos: `ENTRADA`, `SAIDA`, `ROTINA`, `RETORNO_MANUTENCAO`.
- Status: `AGENDADA`, `EM_ANDAMENTO`, `RELATORIO_PENDENTE`, `APROVACAO`, `CONCLUIDA`.
- Checklists dinÃ¢micos por tipo de imÃ³vel, anexos, fotos e geraÃ§Ã£o de pendÃªncias.
- IntegraÃ§Ã£o com manutenÃ§Ã£o: pendÃªncias convertidas em OS automaticamente.

### 5. PendÃªncias e Tarefas

- Registro central de `PENDENCIA` ou `TAREFA` com tÃ­tulo, descriÃ§Ã£o, setor, responsÃ¡vel, prioridade (`BAIXA`, `MEDIA`, `ALTA`, `CRITICA`) e SLA.
- Status: `ABERTA`, `EM_PROGRESSO`, `BLOQUEADA`, `CONCLUIDA`, `CANCELADA`.
- ComentÃ¡rios, anexos, histÃ³rico e alertas de SLA com escalonamento.

### 6. Agenda Integrada

- CalendÃ¡rio semanal/mensal com filtros por setor, responsÃ¡vel e imÃ³vel.
- SincronizaÃ§Ã£o bidirecional com Google Calendar e Outlook.
- Bloqueio de conflitos e visÃµes personalizadas (vistoria, visitas, tarefas).

### 7. ComunicaÃ§Ã£o Interna

- Chat contextual por imÃ³vel, vistoria, negociaÃ§Ã£o ou pendÃªncia.
- MenÃ§Ãµes (@usuario), notificaÃ§Ãµes push/e-mail, histÃ³rico auditÃ¡vel.
- Grupos por setor e threads especÃ­ficas para assuntos crÃ­ticos.

### 8. Documentos e Assinatura Digital

- Modelos parametrizados (contratos, laudos, autorizaÃ§Ãµes) com merge automÃ¡tico de dados.
- IntegraÃ§Ã£o com Clicksign/DocuSign para assinatura eletrÃ´nica.
- Controle de validade, alertas de renovaÃ§Ã£o, histÃ³rico de versÃµes.

### 9. Controle Financeiro

- Registro de sinal, cauÃ§Ã£o, cobranÃ§as e devoluÃ§Ãµes vinculados Ã  negociaÃ§Ã£o.
- Painel por imÃ³vel: aluguel, encargos, taxas, repasses e pendÃªncias.
- Bloqueio automÃ¡tico de reservas com inadimplÃªncia.
- ExportaÃ§Ã£o (CSV/Excel/API) para contabilidade e ERPs.

### 10. GestÃ£o de ManutenÃ§Ãµes

- Ordens de serviÃ§o vinculadas a imÃ³veis, vistorias ou pendÃªncias.
- Fluxo: `SOLICITADA â†’ APROVADA â†’ EM_EXECUCAO â†’ CONCLUIDA`.
- Cadastro de fornecedores, orÃ§amentos e aprovaÃ§Ãµes.
- Checklist final com fotos antes de liberar imÃ³vel para disponibilidade.

### 11. Indicadores e RelatÃ³rios

- MÃ©tricas: taxa de vacÃ¢ncia, tempo mÃ©dio de locaÃ§Ã£o, tempo de vistoria/manutenÃ§Ã£o, conversÃ£o de propostas, desempenho por corretor/setor, custo de manutenÃ§Ã£o.
- RelatÃ³rios comparativos (mensal/anual), exportaÃ§Ã£o PDF/Excel/CSV, integraÃ§Ã£o com Power BI/Metabase.

### 12. Portal do ProprietÃ¡rio

- Status atual, histÃ³rico de vistorias, rendimentos e manutenÃ§Ãµes.
- Download de relatÃ³rios, upload de autorizaÃ§Ãµes e canal de mensagens.

### 13. Portal do Interessado (LocatÃ¡rio)

- Linha do tempo da negociaÃ§Ã£o, upload de documentos, agendamento de visitas, notificaÃ§Ãµes de status.

### 14. Controle de Prioridades

- Matriz de urgÃªncia x impacto com classificaÃ§Ã£o automÃ¡tica (cores: vermelho, amarelo, verde).
- RedistribuiÃ§Ã£o de tarefas para balanceamento de carga entre usuÃ¡rios.

### 15. Logs e Auditoria

- Registro de todas as aÃ§Ãµes (criaÃ§Ã£o, ediÃ§Ã£o, exclusÃ£o) com metadados (IP, dispositivo, data/hora).
- Filtros por perÃ­odo, exportaÃ§Ã£o e retenÃ§Ã£o configurÃ¡vel.

### 16. CRM e Relacionamento com Leads

- Captura automÃ¡tica de leads (site, WhatsApp, portais) via APIs e webhooks.
- ClassificaÃ§Ã£o automÃ¡tica (quente, morno, frio), histÃ³rico de contatos.
- Envio automÃ¡tico de imÃ³veis compatÃ­veis e integraÃ§Ã£o com Zap, OLX, Viva Real etc.

## ğŸ›¢ï¸ Modelo de Dados (alto nÃ­vel)

| Entidade | Campos-chave | RelaÃ§Ãµes principais |
| --- | --- | --- |
| **imoveis** | id, endereÃ§o, tipo, status, data_previsao_disponibilidade | 1:N negociaÃ§Ãµes, vistorias, manutenÃ§Ãµes, pendÃªncias |
| **proprietarios** | id, dados contato, documentos | 1:N imÃ³veis |
| **locatarios** | id, dados contato, score | 1:N negociaÃ§Ãµes |
| **negociacoes** | id, imovel_id, interessado_id, corretor_id, etapa, data_validade_proposta | 1:N propostas, pagamentos, logs |
| **vistorias** | id, imovel_id, tipo, status, checklist, agendamento | 1:N pendÃªncias, anexos |
| **pendencias** | id, origem_tipo, origem_id, tipo, prioridade, status, sla | 1:N tarefas, comentÃ¡rios |
| **tarefas** | id, pendencia_id?, responsÃ¡vel, status, datas | 1:N logs |
| **agendamentos** | id, recurso (vistoria/visita/tarefa), inicio, fim | vinculado a imÃ³veis e usuÃ¡rios |
| **documentos** | id, origem_tipo, origem_id, tipo, versÃ£o, storage_path | --- |
| **ordens_servico** | id, imovel_id, pendencia_id, fornecedor_id, status | 1:N fotos, custos |
| **pagamentos** | id, negociacao_id, tipo (sinal, cauÃ§Ã£o), status | --- |
| **notificacoes** | id, usuario_id, canal, template, status | --- |
| **logs_auditoria** | id, usuario_id, acao, recurso, valores_anteriores/novos | --- |

> Modelagem orientada a eventos permite derivar histÃ³rico completo sem perda de informaÃ§Ãµes. Tabelas de apoio (ex.: `checklist_itens`, `anexos`, `comentarios`, `usuarios`, `perfis`) completam o desenho.

## ğŸ”„ Fluxos AutomÃ¡ticos Principais

1. **Aviso de DesocupaÃ§Ã£o**
   1. SolicitaÃ§Ã£o registrada â†’ altera status do imÃ³vel para `EM_VISTORIA_SAIDA`.
   2. Agenda automaticamente vistoria de saÃ­da e notifica equipe.
   3. ApÃ³s vistoria, pendÃªncias geram OS; finalizado o processo e sem pendÃªncias, status retorna a `DISPONIVEL`.

2. **NegociaÃ§Ã£o com Proposta**
   1. Proposta aceita â†’ bloqueia imÃ³vel (`RESERVADO`).
   2. DocumentaÃ§Ã£o aprovada â†’ gera contrato automÃ¡tico para assinatura digital.
   3. Contrato assinado e pagamentos confirmados â†’ agenda entrega de chaves, muda status para `OCUPADO`.

3. **PendÃªncia CrÃ­tica**
   1. PendÃªncia criada com prioridade `CRITICA` â†’ notifica responsÃ¡veis e gestores.
   2. SLA extrapolado â†’ escalonamento automÃ¡tico, atualizaÃ§Ã£o de status para `BLOQUEADA` se necessÃ¡rio.
   3. ConclusÃ£o â†’ atualiza histÃ³rico e libera disponibilidade quando aplicÃ¡vel.

## ğŸ”” NotificaÃ§Ãµes e Alertas

- **Canais**: in-app, e-mail, push mobile, SMS opcional.
- **Templates**: configurÃ¡veis por evento (expiraÃ§Ã£o de proposta, SLA perto do vencimento, atualizaÃ§Ã£o de etapa).
- **PreferÃªncias de usuÃ¡rio**: opt-in/out por canal, modo silencioso.

## ğŸ“† IntegraÃ§Ãµes Externas

- Google Calendar / Microsoft Outlook (OAuth 2.0) para sincronizaÃ§Ã£o bidirecional de compromissos.
- Portais imobiliÃ¡rios (Zap, OLX, Viva Real) via feeds XML/JSON para captaÃ§Ã£o de leads.
- Sistemas financeiros/contÃ¡beis via exportaÃ§Ã£o CSV ou APIs dedicadas.
- Assinatura eletrÃ´nica (Clicksign, DocuSign) com webhooks para atualizaÃ§Ã£o de status.

## ğŸ” SeguranÃ§a e Conformidade

- AutenticaÃ§Ã£o JWT + refresh tokens; suporte a MFA.
- Armazenamento seguro de arquivos (S3 com KMS, antivÃ­rus ClamAV on-upload).
- Criptografia em repouso e em trÃ¢nsito (TLS 1.2+).
- PolÃ­ticas de backup, retenÃ§Ã£o e LGPD (logs de consentimento, direito ao esquecimento, anonimizaÃ§Ã£o).
- Monitoramento de atividades suspeitas e alertas de seguranÃ§a.

## ğŸ“Š Observabilidade

- Logs centralizados (Elastic Stack ou Loki) com rastreamento distribuÃ­do (OpenTelemetry).
- MÃ©tricas (Prometheus + Grafana) para disponibilidade, tempo de resposta e filas.
- Alertas configurÃ¡veis (PagerDuty, Opsgenie) por criticidade.

## ğŸš€ Roadmap Inicial

1. **MVP Operacional (0-3 meses)**
   - Cadastro de imÃ³veis, pipeline de negociaÃ§Ãµes, agenda bÃ¡sica, RBAC.
   - Portal interno com dashboards e notificaÃ§Ãµes essenciais.
2. **ExpansÃ£o Operacional (3-6 meses)**
   - Vistorias completas, pendÃªncias integradas, manutenÃ§Ã£o com OS.
   - IntegraÃ§Ã£o com assinatura digital e portais externos.
3. **ExcelÃªncia e Analytics (6-12 meses)**
   - Indicadores avanÃ§ados, portais externos completos, automaÃ§Ãµes de SLA.
   - Observabilidade e compliance completos, integraÃ§Ãµes financeiras avanÃ§adas.

## âœ… BenefÃ­cios Esperados

- Visibilidade em tempo real sobre o ciclo completo de locaÃ§Ã£o.
- ComunicaÃ§Ã£o integrada e rastreÃ¡vel entre setores.
- ReduÃ§Ã£o de conflitos de agenda e atrasos operacionais.
- Tomada de decisÃ£o guiada por dados histÃ³ricos confiÃ¡veis.

