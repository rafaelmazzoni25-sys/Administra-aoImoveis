@model ScheduleCalendarViewModel
@{
    ViewData["Title"] = "Agenda Interna";
}
<section class="space-y-6">
    <form method="get" class="bg-white p-4 rounded shadow flex flex-wrap gap-4 items-end">
        <div>
            <label class="label" for="inicio">Início</label>
            <input class="input" type="date" id="inicio" name="inicio" value="@Model.Inicio.ToString("yyyy-MM-dd")" />
        </div>
        <div>
            <label class="label" for="fim">Fim</label>
            <input class="input" type="date" id="fim" name="fim" value="@Model.Fim.ToString("yyyy-MM-dd")" />
        </div>
        <button class="btn-primary" type="submit">Aplicar</button>
    </form>

    <div class="bg-white rounded shadow">
        <table class="table">
            <thead>
                <tr>
                    <th>Título</th>
                    <th>Tipo</th>
                    <th>Responsável</th>
                    <th>Início</th>
                    <th>Fim</th>
                    <th>Conflitos</th>
                </tr>
            </thead>
            <tbody>
                @if (!Model.Compromissos.Any())
                {
                    <tr>
                        <td colspan="6" class="py-6 text-center text-slate-500">Nenhum compromisso no período informado.</td>
                    </tr>
                }
                else
                {
                    foreach (var item in Model.Compromissos)
                    {
                        var rowClass = item.TemConflito ? "bg-red-50" : string.Empty;
                        <tr class="@rowClass">
                            <td>@item.Titulo</td>
                            <td>@item.Tipo</td>
                            <td>@item.Responsavel</td>
                            <td>@item.Inicio:dd/MM/yyyy HH:mm</td>
                            <td>@item.Fim:dd/MM/yyyy HH:mm</td>
                            <td class="space-y-1">
                                @if (item.TemConflito)
                                {
                                    foreach (var conflito in item.Conflitos)
                                    {
                                        <div class="flex flex-col text-sm">
                                            <span class="font-medium text-red-700">@conflito.Escopo</span>
                                            <span class="text-slate-600">@conflito.Titulo (@conflito.Inicio:dd/MM HH:mm - @conflito.Fim:dd/MM HH:mm)</span>
                                            @if (!string.IsNullOrWhiteSpace(conflito.Responsavel))
                                            {
                                                <span class="text-slate-500">Responsável: @conflito.Responsavel</span>
                                            }
                                        </div>
                                    }
                                }
                                else
                                {
                                    <span class="text-slate-400">Sem conflitos</span>
                                }
                            </td>
                        </tr>
                    }
                }
            </tbody>
        </table>
    </div>
</section>
