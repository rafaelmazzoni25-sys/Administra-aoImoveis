@model FinancialTransactionListViewModel
@using System.Globalization
@{
    Layout = null;
    var cultura = CultureInfo.GetCultureInfo("pt-BR");
    var geradoEm = ViewData["GeradoEm"] as DateTime? ?? DateTime.UtcNow;
}
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8" />
    <title>@(ViewData["Titulo"] ?? "Relatório financeiro")</title>
    <style>
        body { font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif; margin: 24px; color: #1f2937; }
        h1 { font-size: 24px; margin-bottom: 8px; }
        h2 { font-size: 18px; margin-top: 24px; margin-bottom: 8px; }
        table { width: 100%; border-collapse: collapse; margin-top: 12px; }
        th, td { border: 1px solid #cbd5f5; padding: 6px 10px; font-size: 13px; text-align: left; }
        th { background: #f1f5f9; text-transform: uppercase; font-size: 12px; letter-spacing: 0.04em; }
        .summary { display: flex; gap: 16px; flex-wrap: wrap; margin-top: 16px; }
        .summary div { background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 6px; padding: 12px 16px; min-width: 160px; }
        .summary span { display: block; font-size: 12px; text-transform: uppercase; color: #64748b; margin-bottom: 4px; }
        .summary strong { font-size: 16px; }
        footer { margin-top: 32px; font-size: 12px; color: #64748b; }
    </style>
</head>
<body>
    <header>
        <h1>@(ViewData["Titulo"] ?? "Relatório financeiro")</h1>
        <p>Imóvel: <strong>@Model.Imovel</strong></p>
        <p>Interessado: <strong>@Model.Interessado</strong></p>
        <p>Status da negociação: <strong>@Model.Etapa</strong> (@(Model.NegociacaoAtiva ? "ativa" : "encerrada"))</p>
        <p>Gerado em @geradoEm.ToLocalTime().ToString("dd/MM/yyyy HH:mm")</p>
    </header>

    <section class="summary">
        <div>
            <span>Total previsto</span>
            <strong>@Model.TotalPrevisto.ToString("C", cultura)</strong>
        </div>
        <div>
            <span>Total recebido</span>
            <strong>@Model.TotalRecebido.ToString("C", cultura)</strong>
        </div>
        <div>
            <span>Total devolvido</span>
            <strong>@Model.TotalDevolvido.ToString("C", cultura)</strong>
        </div>
        <div>
            <span>Pendente</span>
            <strong>@Model.TotalPendente.ToString("C", cultura)</strong>
        </div>
    </section>

    <section>
        <h2>Lançamentos registrados</h2>
        <table>
            <thead>
                <tr>
                    <th>Tipo</th>
                    <th>Valor</th>
                    <th>Status</th>
                    <th>Previsto para</th>
                    <th>Efetivado em</th>
                    <th>Observações</th>
                </tr>
            </thead>
            <tbody>
            @if (!Model.Lancamentos.Any())
            {
                <tr>
                    <td colspan="6">Nenhum lançamento cadastrado.</td>
                </tr>
            }
            else
            {
                foreach (var item in Model.Lancamentos)
                {
                    <tr>
                        <td>
                            <strong>@item.TipoLancamento</strong><br />
                            <span>Criado em @item.CriadoEm.ToLocalTime().ToString("dd/MM/yyyy HH:mm") por @item.CriadoPor</span>
                        </td>
                        <td>@item.Valor.ToString("C", cultura)</td>
                        <td>@item.Status</td>
                        <td>@(item.DataPrevista?.ToString("dd/MM/yyyy", cultura) ?? "-")</td>
                        <td>@(item.DataEfetivacao?.ToString("dd/MM/yyyy", cultura) ?? "-")</td>
                        <td>@(string.IsNullOrWhiteSpace(item.Observacao) ? "-" : item.Observacao)</td>
                    </tr>
                }
            }
            </tbody>
        </table>
    </section>

    <footer>
        Relatório gerado pelo módulo financeiro interno. Utilize a impressora "Microsoft Print to PDF" para salvar este conteúdo.
    </footer>
</body>
</html>
